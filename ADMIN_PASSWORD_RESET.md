# 管理员密码重置工具

本项目提供了两种方式来通过命令行重置管理员密码。

## 方法1：交互式密码重置（推荐）

使用交互式工具，密码输入时会被隐藏，更加安全：

```bash
npm run reset-password
```

或者直接运行：

```bash
node scripts/reset-admin-password.js
```

### 特性：
- ✅ 密码输入时隐藏显示（显示为 `*`）
- ✅ 密码确认验证
- ✅ 密码强度验证（至少6位字符）
- ✅ 支持自定义管理员用户名
- ✅ 详细的错误提示和帮助信息

### 使用流程：
1. 运行命令后，会提示输入管理员用户名（默认：admin）
2. 输入新密码（输入时显示为星号）
3. 再次输入密码进行确认
4. 系统验证并更新密码

## 方法2：快速密码重置

如果需要快速重置密码，可以直接通过命令行参数传递：

```bash
npm run quick-reset <新密码> [用户名]
```

或者直接运行：

```bash
node scripts/quick-reset-password.js <新密码> [用户名]
```

### 示例：

```bash
# 重置默认admin用户的密码
npm run quick-reset myNewPassword123

# 重置指定用户的密码
npm run quick-reset myNewPassword123 admin

# 直接运行脚本
node scripts/quick-reset-password.js myNewPassword123
```

### 特性：
- ⚡ 快速执行，一行命令完成
- ✅ 密码强度验证（至少6位字符）
- ✅ 支持自定义管理员用户名
- ⚠️  密码会在命令行历史中可见（安全性较低）

## 安全建议

1. **推荐使用交互式方式** (`npm run reset-password`)，因为密码不会在命令行历史中留下记录
2. **快速重置方式** 适合脚本化场景，但要注意清理命令行历史
3. **密码要求**：至少6位字符，建议使用强密码
4. **操作确认**：密码修改后立即生效，请确保记住新密码

## 故障排除

### 常见错误：

1. **数据库连接失败**
   ```
   ❌ 数据库连接失败: SQLITE_CANTOPEN: unable to open database file
   ```
   - 确保在项目根目录运行命令
   - 确保 `database.sqlite` 文件存在

2. **管理员用户不存在**
   ```
   ❌ 管理员用户 "admin" 不存在
   ```
   - 检查用户名是否正确
   - 确保数据库中存在该管理员用户

3. **密码过短**
   ```
   ❌ 密码至少需要6位字符
   ```
   - 使用至少6位字符的密码

### 验证密码重置是否成功：

重置密码后，可以通过以下方式验证：

1. 启动应用：`npm run dev`
2. 访问管理员登录页面
3. 使用新密码登录测试

## 默认账户信息

- **默认用户名**：`admin`
- **初始密码**：`admin123`（首次启动时创建）

如果忘记了所有管理员密码，可以：
1. 删除 `database.sqlite` 文件
2. 重新启动应用，系统会重新创建默认管理员账户 